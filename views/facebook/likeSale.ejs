<!DOCTYPE html>

<html
  lang="en"
  class="light-style layout-menu-fixed"
  dir="ltr"
  data-theme="theme-default"
  data-assets-path="../assets/"
  data-template="vertical-menu-template-free"
>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />

    <title>Mua Like Facebook</title>

    <meta name="description" content="" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet"
    />

    <!-- Icons. Uncomment required icon fonts -->
    <link rel="stylesheet" href="/assets/vendor/fonts/boxicons.css" />

    <!-- Core CSS -->
    <link
      rel="stylesheet"
      href="/assets/vendor/css/core.css"
      class="template-customizer-core-css"
    />
    <link
      rel="stylesheet"
      href="/assets/vendor/css/theme-default.css"
      class="template-customizer-theme-css"
    />
    <link rel="stylesheet" href="/assets/css/demo.css" />

    <!-- Vendors CSS -->
    <link
      rel="stylesheet"
      href="/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css"
    />

    <link
      rel="stylesheet"
      href="/assets/vendor/libs/apex-charts/apex-charts.css"
    />

    <!-- Page CSS -->

    <!-- Helpers -->
    <script src="/assets/vendor/js/helpers.js"></script>

    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script src="/assets/js/config.js"></script>
    <%- include('../main') %>
  </head>

  <body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">
        <!-- Menu -->
        <%- include('../partials/sidebar', {index: 'facebook' }) %>
        <!-- / Menu -->

        <!-- Layout container -->
        <div class="layout-page">
          <!-- Navbar -->
          <%- include('../partials/top') %>
          <!-- / Navbar -->

          <!-- Content wrapper -->
          <div class="content-wrapper">
            <!-- Content -->
            <div class="container-xxl flex-grow-1 container-p-y">
              <div class="row">
                <div class="col-12 card__chat">
                  <div class="card shadow">
                    <div class="card-header">
                      <div
                        class="btn-shine badge border-bottom border-2 border-blue p-1"
                      >
                        Mua like (Sale)
                      </div>
                    </div>
                    <div class="card-body">
                      <div class="nav-align-top">
                        <ul class="nav nav-pills mb-3 nav-fill" role="tablist">
                          <li class="nav-item mx-1">
                            <button
                              type="button"
                              class="nav-link border-1 fw-bolder active"
                              role="tab"
                              data-bs-toggle="tab"
                              data-bs-target="#navs-pills-justified-home"
                              aria-controls="navs-pills-justified-home"
                              style="border: 1px #007bff solid !important"
                              aria-selected="true"
                            >
                              Thêm đơn
                            </button>
                          </li>
                          <li class="nav-item mx-1">
                            <button
                              type="button"
                              class="nav-link border-1 fw-bolder"
                              role="tab"
                              data-bs-toggle="tab"
                              data-bs-target="#navs-pills-justified-profile"
                              aria-controls="navs-pills-justified-profile"
                              style="border: 1px #007bff solid !important"
                              aria-selected="false"
                            >
                              Quản lý đơn
                            </button>
                          </li>
                        </ul>
                        <div class="tab-content">
                          <div
                            class="tab-pane fade show active"
                            id="navs-pills-justified-home"
                            role="tabpanel"
                          >
                            <div class="row">
                              <div class="row">
                                <div class="col-lg-8 mt-3">
                                  <div class="card ribbon-box">
                                    <div class="card-body">
                                      <form id="form-post-like" action="/api/post/service/facebook/like-post-sale/order" method="POST" style="font-size: 15px">
                                        <div class="row mb-3">
                                          <div class="col-lg-3">
                                            <label
                                              for="url"
                                              class="form-label"
                                              >Link bài viết:</label
                                            >
                                          </div>
                                          <div class="col-lg-9">
                                            <input
                                              type="url"
                                              id="url"
                                              class="form-control"
                                              placeholder="Nhập link bài viết cần tăng"
                                              name="link_post"
                                            />
                                          </div>
                                        </div>
                                        <style>
                                          .pack:hover {
                                            color: #fff;
                                            box-shadow: inset 200px 0 0 0
                                              #54b3d6;
                                          }
                                        </style>
                                        <div class="row mb-3">
                                          <div class="col-lg-3">
                                            <label
                                              for="nameInput"
                                              class="form-label"
                                              >Gói dịch vụ</label
                                            >
                                          </div>
                                          <div class="col-lg-9">
                                            <% service.forEach(function(sv){ %>
                                                <div class="form-check">
                                                  <input
                                                    type="radio"
                                                    class="form-check-input pack"
                                                    id="sv<%= sv.serverservice %>"
                                                    detail="<%= sv.servername %>" data-rate="<%= sv.rateservice %>"
                                                                            name="server_order" onchange="bill();" value="sv<%= sv.serverservice %>"
                                                                            reaction-show="like"><label
                                                    class="form-check-label"
                                                    for="sv<%= sv.serverservice %>"
                                                  >
                                                  Gói v<%= sv.serverservice %> (<%= sv.titleservice %>)&nbsp;<b
                                                  class="text-warning">
                                                    <% if (sv.statusservice == 0) { %>
                                                      (Bảo trì)&nbsp;
                                                    <% } %>
                                                    <span
                                                      class="badge badge-label bg-info"
                                                      >Giá <%= sv.rateservice %>đ</span
                                                    ></b>
                                                  </label>
                                                </div>
                                                <% }); %>
                                          </div>
                                        </div>
                                        <div class="form-check form-check-inline" hidden>
                                          <label class="form-check-label " for="reaction0">
                                              <input class="form-check-input checkbox d-none"
                                                  type="radio" data-prices="101" id="reaction0"
                                                  name="reaction" value="like" checked="checked">
                                          </label>
                                      </div>
                                      <div id="detailServer"></div>
                                        <div
                                          class="row mb-3"
                                          style="display: none"
                                          id="show_comment"
                                        >
                                        </div>
                                        <div id="show_soluong" class="row mb-3">
                                          <div class="col-lg-3">
                                            <label
                                              for="nameInput"
                                              class="form-label"
                                              >Số lượng cần mua</label
                                            >
                                          </div>
                                          <div class="col-lg-9">
                                            <input
                                              type="number"
                                              id="amount"
                                              name="amount"
                                              class="form-control"
                                              value="100"
                                              onkeyup="bill();"
                                              placeholder="Nhập số lượng cần mua"
                                            />
                                          </div>
                                        </div>
                                        <div class="row mb-3">
                                          <div class="col-lg-3">
                                            <label
                                              for="nameInput"
                                              class="form-label"
                                              >Ghi chú đơn hàng</label
                                            >
                                          </div>
                                          <div class="col-lg-9">
                                            <textarea
                                              class="form-control"
                                              rows="3"
                                              id="note"
                                              placeholder="Nhập ghi chú đơn hàng nếu có"
                                            ></textarea>
                                          </div>
                                        </div>
                                        <div class="form-group text-center">
                                          <div
                                            class="alert alert-primary alert-dismissible alert-outline fade show"
                                            role="alert"
                                          >
                                            <h5>Số dư của bạn: <b><%= totalMoney %>đ</b></h5>
                                            <h4>
                                              Số tiền cần thanh toán:
                                              <b id="total_payment" style="color: red"
                                                >0đ</b
                                              >
                                            </h4>
                                          </div>
                                        </div>
                                        <div class="form-group row">
                                          <div
                                            class="col-lg-12 fv-row text-center"
                                          >
                                            <button
                                              type="button"
                                              id="buy"
                                              class="btn btn-danger"
                                            >
                                              Thêm đơn
                                            </button>
                                          </div>
                                        </div>
                                      </form>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-lg-4 mt-3">
                                  <div class="card ribbon-box">
                                    <div class="card-body">
                                      <div class="mb-3">
                                        <div class="fw-bold text-danger">
                                          LƯU Ý
                                        </div>
                                      </div>
                                      <p>Chú ý:</p>

                                      <p>
                                        - Nghiêm cấm buff các đơn có nội dung vi phạm pháp luật, chính trị, đồ trụy... Nếu cố tình buff bạn sẽ bị trừ hết tiền và ban khỏi hệ thống vĩnh viễn, và phải chịu hoàn toàn trách nhiệm trước pháp luật.
                                      </p>
                                      <p>
                                        - Nếu đơn đang chạy trên hệ thống mà bạn vẫn mua ở các hệ thống bên khác, nếu có tình trạng hụt, thiếu số lượng giữa 2 bên thì sẽ không được xử lí.
                                      </p>
                                      <p>
                                        - Đơn cài sai thông tin hoặc lỗi trong quá trình tăng hệ thống sẽ không hoàn lại tiền.
                                      </p>
                                      <p>
                                        - Nếu gặp lỗi hãy nhắn tin hỗ trợ phía bên phải góc màn hình hoặc vào mục liên hệ hỗ trợ để được hỗ trợ tốt nhất.
                                      </p>
                                    </div>
                                  </div>
                                </div>
                                <br />
                                <center></center>
                              </div>
                            </div>
                          </div>
                          <div
                            class="tab-pane fade"
                            id="navs-pills-justified-profile"
                            role="tabpanel"
                          >
                            <div class="row mt-2">
                              <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="home-notification">
                                            <div class="table-responsive text-nowrap">
                                                <table class="table" id="dataTable">
                                                    <thead class="bg-primary">
                                                        <tr class="text-center table-dark shadow">
                                                          <th class="text-white">ID</th>
                                                          <th class="text-white">Thời gian</th>
                                                          <th class="text-white">Mã đơn</th>
                                                          <th class="text-white">Link bài viết</th>
                                                          <th class="text-white">Máy chủ</th>
                                                          <th class="text-white">Loại</th>
                                                          <th class="text-white">Số lượng</th>
                                                          <th class="text-white">Bắt đầu</th>
                                                          <th class="text-white">Ghi chú</th>
                                                          <th class="text-white">Tổng tiền</th>
                                                          <th class="text-white">Trạng thái</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="text-center">
                                                      <% order.forEach(function(orders){ %>
                                                        <tr class="">
                                                          <td><%= orders.orderId %></td>
                                                          <td><%= orders.time %></td>
                                                          <td><%= orders.codeOrder %></td>
                                                          <td><p>
                                                                  <a href="<%= orders.idPost %>" target="_blank" style="color: #696cff; text-decoration: none;"><%= orders.idPost %></a>
                                                              </p>
                                                          </td>
                                                          <td><span class="badge bg-pip text-black"><%= orders.server %></span></td>
                                                          <td><%= orders.react %></td>
                                                          <td><span class="text-danger font-weight-bold"><%= orders.amount %></span> <sup>like</sup></td>
                                                          <td><span class="text-danger font-weight-bold"><%= orders.start %></span> <sup>like</sup></td>
                                                          <td><textarea class="form-control" readonly=""><%= orders.note %></textarea></td>
                                                          <td><span class="text-danger font-weight-bold"><%= orders.total %></span> <sup>coin</sup></td>
                                                          <td><span class="badge bg-success text-white"><%= orders.status %></span></td>
                                                      </tr>
                                                    <% }); %>
                                                    <% if (order.length == 0) { %>
                                                      <tr class="odd">
                                                        <td valign="top" colspan="100%">
                                                            <center>
                                                                <img src="/assets/images/no-data.png" alt="" width="120"
                                                                    height="120">
                                                                <p>Không có dữ liệu để hiển thị</p>
                                                            </center>
                                                        </td>
                                                    </tr>
                                                    <% } %>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- / Content -->

            <!-- Footer -->
            <%- include('../partials/footer') %>
            <!-- / Footer -->

            <div class="content-backdrop fade"></div>
          </div>
          <!-- Content wrapper -->
        </div>
        <!-- / Layout page -->
      </div>

      <!-- Overlay -->
      <div class="layout-overlay layout-menu-toggle"></div>
    </div>
    <!-- / Layout wrapper -->
    <!-- Core JS -->
    <!-- build:js assets/vendor/js/core.js -->
    <!-- SweetAlert -->

    <script src="/assets/vendor/libs/jquery/jquery.js"></script>
    <script src="/assets/vendor/libs/popper/popper.js"></script>
    <script src="/assets/vendor/js/bootstrap.js"></script>
    <script src="/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>

    <script src="/assets/vendor/js/menu.js"></script>
    <!-- endbuild -->

    <!-- Vendors JS -->
    <script src="/assets/vendor/libs/apex-charts/apexcharts.js"></script>

    <!-- Main JS -->
    <script src="/assets/js/main.js"></script>

    <!-- Page JS -->
    <script src="/assets/js/dashboards-analytics.js"></script>
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script>
      function getUID(elm) {
      $('#buy').prop("disabled", true);
      setTimeout(() => {
          let link = $('[name=' + elm + ']').val();
          if (!isURL(link)) {
              $('#buy').prop("disabled", false);
              return;
          }
          $('[name=' + elm + ']').prop("disabled", true).val('Đang xử lý');
          $.ajax({
              type: "GET",
              url: "https://subgiare.vn/api/tool/get-uid-fb",
              data: {
                  link
              },
              dataType: "json",
              success: function(response) {
                  if (response.status === 200) {
                      $('[name=' + elm + ']').prop("disabled", false).val(response.data);
                  } else {
                      $('[name=' + elm + ']').prop("disabled", false).val('');
                  }
                  $('#buy').prop("disabled", false);
              }
          });
      }, 100);
  }
  function detailServer(text) {
      if (text) {
          $('#detailServer').show().html(`<div class="alert bg-warning text-white detailServer mt-2 mb-2 role="alert">
            - <b>${text}</b></div>`);
      } else {}
  }

  function resetReaction(server = null) {
      let reactions = $('[name=reaction]');
      let shows = server.attr('reaction-show');
      shows = !shows ? [] : shows.split(',');
      $.each(reactions, function(index, reaction) {
          let elm = $(reaction).parent().parent();
          if (!server.val() || !shows.length) {
              elm.show();
          } else {
          if(shows.indexOf($(reaction).val()) >= 0){
              elm.show();
          }else{
              elm.hide();
          }
          }
      });
  }

  function bill() {
      let server_order = $('input[name=server_order]:checked');
      resetReaction(server_order);
      let detail = server_order.attr('detail');
      detailServer(detail);
      price = server_order.data("rate");
      server_order = server_order.val();
      if (!server_order) return;
      const numberFormatter = Intl.NumberFormat('en-US');
      let amount = $('[name=amount]').val();
      let total_payment = Math.round(amount * price) || 0;
      const total = `${numberFormatter.format(total_payment)}đ`;
      $('#total_payment').html(total);
      
  }
  $(document).ready(function() {
      bill();
  });

  $('#buy').click((e) => {
      e.preventDefault();
      Swal.fire({
          title: 'Xác nhận thanh toán!',
          text: "Bạn có muốn thanh toán đơn hàng? Chúng tôi sẽ không hoàn tiền với đơn đã thanh toán.",
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#7066e0',
          confirmButtonText: 'Tôi đồng ý',
          cancelButtonColor: '#d33',
          cancelButtonText: 'Đóng',
      }).then((result) => {
      if (result.isConfirmed) {
          document.getElementById('form-post-like').submit();
      }
    })
  })
  </script>    
  <% if (success.length > 0) { %>
    <script>
      Swal.fire({
        title: 'Thông báo',
        confirmButtonColor: '#007bff',
        text: 'Thêm đơn thành công',
        icon: 'success',
        confirmButtonText: 'Tôi đã hiểu',
      })
  </script>
  <% } %>
  <% if (err.length > 0) { %>
    <script>
      Swal.fire({
        title: 'Có lỗi xảy ra',
        confirmButtonColor: '#007bff',
        text: '<%= err %>',
        icon: 'error',
        confirmButtonText: 'Tôi đã hiểu',
      })
  </script>
  <% } %>
  </body>
</html>
